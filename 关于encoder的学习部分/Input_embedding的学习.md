# 需要的素材
Input_embedding的实现需要用到nn.Embedding(num_embeddings, embedding_dim)
nn.Embedding输入的整数索引张量会通过查找嵌入矩阵，将每个索引转换为对应的嵌入向量。

# nn.Embedding的内部实现流程
1. nn.Embedding 创建一个**权重矩阵**，形状为(num_embeddings,embedding_dim)（支持的索引数，向量维度）
2. 输入到nn.Embedding 中的是**张量tensor格式的数据**
3. 按索引从嵌入矩阵 𝑊 中提取对应的行
4. 输出嵌入张量 (sequence_length,embedding_dim)

# 示例
### 1. 嵌入矩阵的初始化

`nn.Embedding` 创建一个权重矩阵（嵌入矩阵），其形状为：

\[
(\text{num\_embeddings}, \text{embedding\_dim})
\]

在你的例子中：

- `num_embeddings = 10`（支持的索引数）。
- `embedding_dim = 4`（每个索引的嵌入向量维度）。

嵌入矩阵是一个随机初始化的张量 \( W \)，例如：

```plaintext
W = tensor([
    [-1.3128, -1.5943,  0.8361,  0.1759],  # 索引 0 的嵌入向量
    [-1.5642,  0.8472,  1.5004,  1.4998],  # 索引 1 的嵌入向量
    [ 0.1175, -0.2854,  1.0687,  1.1457],  # 索引 2 的嵌入向量
    [ 0.8753,  0.8071,  1.8002,  0.1741],  # 索引 3 的嵌入向量
    [-0.1592,  1.2202, -1.2174, -1.6686],  # 索引 4 的嵌入向量
    [ 1.8995,  0.3442,  0.4810,  0.5852],  # 索引 5 的嵌入向量
    [ 2.4130, -0.2945, -1.0100,  0.8077],  # 索引 6 的嵌入向量
    [ 0.0881, -0.9327, -1.1154,  0.4523],  # 索引 7 的嵌入向量
    ...
])
```

每一行 \( W[i] \) 对应标识 \( i \) 的嵌入向量。这些向量被随机初始化，并会在训练过程中更新。

---

### 2. 输入张量的索引查找

输入张量 `sentence_tensor` 是：

```plaintext
tensor([0, 1, 2, 3, 4, 5, 6, 7])
```

对于每个输入索引 \( i \)，`nn.Embedding` 会从嵌入矩阵 \( W \) 中提取第 \( i \) 行的向量 \( W[i] \)。

#### 查找过程

`sentence_tensor` 是一个向量，每个元素是一个整数索引：

- 输入 `0` → 查找 \( W[0] = [-1.3128, -1.5943, 0.8361, 0.1759] \)
- 输入 `1` → 查找 \( W[1] = [-1.5642, 0.8472, 1.5004, 1.4998] \)
- 输入 `2` → 查找 \( W[2] = [0.1175, -0.2854, 1.0687, 1.1457] \)
- 输入 `3` → 查找 \( W[3] = [0.8753, 0.8071, 1.8002, 0.1741] \)

以此类推。

---

#### 结果

嵌入结果是一个二维张量（输入序列中的每个索引被转换为对应的嵌入向量）：

```plaintext
embedded_sentence = tensor([
    [-1.3128, -1.5943,  0.8361,  0.1759],  # 对应索引 0 的嵌入
    [-1.5642,  0.8472,  1.5004,  1.4998],  # 对应索引 1 的嵌入
    [ 0.1175, -0.2854,  1.0687,  1.1457],  # 对应索引 2 的嵌入
    [ 0.8753,  0.8071,  1.8002,  0.1741],  # 对应索引 3 的嵌入
    [-0.1592,  1.2202, -1.2174, -1.6686],  # 对应索引 4 的嵌入
    [ 1.8995,  0.3442,  0.4810,  0.5852],  # 对应索引 5 的嵌入
    [ 2.4130, -0.2945, -1.0100,  0.8077],  # 对应索引 6 的嵌入
    [ 0.0881, -0.9327, -1.1154,  0.4523],  # 对应索引 7 的嵌入
])
```
